[supervisord]
nodaemon=true
logfile=logs/supervisord.log
pidfile=supervisor/supervisord.pid
childlogdir=logs

; --- Web UI (localhost only) ---
[inet_http_server]
port=127.0.0.1:9001
username=admin
password=admin

; --- Control socket (used by supervisorctl) ---
[unix_http_server]
file=/tmp/camera-race-streamer-supervisor.sock
chmod=0700

[supervisorctl]
serverurl=unix:////tmp/camera-race-streamer-supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

; ------------------------------
; Programs
; Replace the "command=" lines below with your real commands.
; Each program is wrapped so logs are prefixed and merged into logs/all.log.
; ------------------------------

[program:bus]
directory=bus-module
command=/bin/sh -lc './bus 2>&1 | sed -u "s/^/[bus] /"'
autostart=false
autorestart=true
startretries=10
startsecs=2
stopsignal=TERM
stopwaitsecs=10
killasgroup=true
stopasgroup=true
stdout_logfile=logs/bus.log
stdout_logfile_maxbytes=0
stderr_logfile=logs/err.log
stderr_logfile_maxbytes=0
environment=RUN_DIR="/tmp"

[program:clock]
directory=clock-module
command=/bin/sh -lc './clock 2>&1 | sed -u "s/^/[clock] /"'
autostart=false
autorestart=true
startretries=10
startsecs=2
stopsignal=TERM
stopwaitsecs=10
killasgroup=true
stopasgroup=true
stdout_logfile=logs/clock.log
stdout_logfile_maxbytes=0
stderr_logfile=logs/err.log
stderr_logfile_maxbytes=0
environment=RUN_DIR="/tmp",SAS_TOKEN="sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiytfx&se=2026-12-19T00:15:07Z&st=2025-12-18T16:00:07Z&spr=https&sig=7LQk%%2BowDHaHz%%2FWhR72PfAEogdMD2RbHzM8FrE1b9lt8%%3D",LOG_LEVEL="DEBUG"

# [program:left-camera]
# directory=frame-producer-module
# command=/bin/sh -lc './racestreamer 2>&1 | sed -u "s/^/[left camera] /"'
# autostart=false
# autorestart=false
# startretries=10
# startsecs=2
# stopsignal=TERM
# stopwaitsecs=10
# killasgroup=true
# stopasgroup=true
# stdout_logfile=logs/left-camera.log
# stdout_logfile_maxbytes=0
# stderr_logfile=logs/err.log
# stderr_logfile_maxbytes=0
# environment=RUN_DIR="/tmp",SAS_TOKEN="sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiytfx&se=2026-12-19T00:15:07Z&st=2025-12-18T16:00:07Z&spr=https&sig=7LQk%%2BowDHaHz%%2FWhR72PfAEogdMD2RbHzM8FrE1b9lt8%%3D",UN="orcavision",CAMERA_ID=0,PW="TheOrca#1",CAMERA_IP="wingate-left.local"

[program:right-camera]
directory=frame-producer-module
command=/bin/sh -lc './racestreamer 2>&1 | sed -u "s/^/[right camera] /"'
autostart=false
autorestart=false
startretries=10
startsecs=2
stopsignal=TERM
stopwaitsecs=10
killasgroup=true
stopasgroup=true
stdout_logfile=logs/right-camera.log
stdout_logfile_maxbytes=0
stderr_logfile=logs/err.log
stderr_logfile_maxbytes=0
environment=RUN_DIR="/tmp",SAS_TOKEN="sv=2024-11-04&ss=bfqt&srt=sco&sp=rwdlacupiytfx&se=2026-12-19T00:15:07Z&st=2025-12-18T16:00:07Z&spr=https&sig=7LQk%%2BowDHaHz%%2FWhR72PfAEogdMD2RbHzM8FrE1b9lt8%%3D",UN="orcavision",CAMERA_ID=1,PW="TheOrca#1",CAMERA_IP="orcarace-right.local",LOG_LEVEL="DEBUG"
